import{r as c,h as e,F as m,j as r,q as S}from"./react-1b56b61c.js";import{s as j}from"./collector.module-c951668d.js";import{b as C,d as N,r as _,c as w,O as z,p as O,j as b,t as T,P as J,Q as M,R,x as U}from"./index-c941e042.js";import{J as y,K as L,h as Y,k as D,ar as I,a2 as B,S as q,aj as p,as as G,at as H}from"./vendor-e7a31927.js";import{I as K}from"./index-3f56dd29.js";import{a as Q,u as W}from"./react-redux-6f2a0ace.js";import"./lodash-87ac67d6.js";import"./react-router-dom-1f34616f.js";const V=({id:t})=>{const i=w("collector",j),[o,h]=c.exports.useReducer(v,[]),n=c.exports.useRef(null);let u=-1;async function g(){var d;if(!t)return;const l=await z(t,u);h({type:u===-1?"reset":"add",payload:l.subscribers}),(d=n.current)==null||d.call(n,l.hasMore),u=l.time}function v(l,{type:s="reset",payload:d}){return s==="reset"?d:[...l,...d]}return c.exports.useEffect(()=>(g(),C),[t]),e(m,{children:[r("div",{className:i(),children:o.map(l=>e("div",{className:i("item"),children:[r(N,{className:i("img"),src:_(l.avatarUrl,100)}),e("div",{children:[r("div",{className:i("title"),children:l.nickname}),l.signature&&r("div",{className:i("subtitle"),children:l.signature})]})]},l.userId))}),r(K,{ref:n,cb:g})]})},E=({item:t,onItemClick:i})=>{const o=w("radio-list");return e("div",{className:o("item"),children:[r("div",{className:o("ordinal"),children:t.serialNum}),r(N,{className:o("cover"),icon:{hoverDisplay:!0},src:_(t.coverUrl,60),onClick:()=>i==null?void 0:i(t.mainSong.id),onIconClick:()=>i==null?void 0:i(t.mainSong.id)}),r("div",{className:o("name"),children:t.name}),e("div",{className:o("play-count"),children:[r(y,{})," ",t.trackCount]}),e("div",{className:o("like-count"),children:[r(L,{})," ",t.likedCount]}),r("div",{className:o("date"),children:Y(t.createTime).format("YYYY-MM-DD")}),r("div",{className:o("duration"),children:O(t.duration)})]})},sr=()=>{const t=w("list"),i=w("radio-list"),o=S(),h=c.exports.useMemo(()=>Number(o.id),[o.id]),n=c.exports.useMemo(()=>!!o.type,[o.type]),[u,g]=c.exports.useState([]),v=c.exports.useMemo(()=>u.sort((a,f)=>a.createTime-f.createTime).slice(0,3),[u]),l=c.exports.useMemo(()=>u.filter(a=>a.programFeeType===5),[u]),s=Q(a=>a.djDetail),d=W();async function x(){const a=await J(h);d(M(a.data))}async function A(){const a=await R(h);g(a.programs)}async function F(a){d(U(a))}function k(){var a;return e(m,{children:[e("div",{className:t("user-info"),children:[r("img",{src:s.dj&&T(_(s.dj.avatarUrl,30)),alt:"avatar"}),r("a",{children:(a=s.dj)==null?void 0:a.nickname})]}),e("div",{className:t("control"),children:[r(b,{compose:!0}),e(b,{children:[r(q,{}),"\u5DF2\u8BA2\u9605(",s.subCount,")"]}),e(b,{children:[r(B,{}),"\u5206\u4EAB(",s.shareCount,")"]})]}),e("div",{className:i("tag"),children:[r("span",{children:s.category}),r("strong",{children:s.desc})]})]})}function P(){var a,f;return e(m,{children:[e("div",{className:i("price"),children:["\xA5",(((a=s==null?void 0:s.feeInfo)==null?void 0:a.originalPrice)||0)/100]}),e("div",{className:i("buttons"),children:[e("button",{className:D(i("button"),"--bg"),children:[r(I,{}),"\u7ACB\u5373\u8D2D\u4E70"]}),e("button",{className:D(i("button"),"--border"),children:[r(y,{}),"\u514D\u8D39\u8BD5\u542C"]}),e(b,{children:[r(B,{}),"\u5206\u4EAB(175)"]})]}),r("div",{className:i("slogan"),children:(f=s.feeInfo)==null?void 0:f.slogan}),r("small",{className:i("brief"),children:"\u6700\u65B0\u4E0A\u67B6"})]})}return c.exports.useEffect(()=>{if(!Number.isNaN(h))return x(),A(),C},[h]),e("div",{className:t(),children:[e("header",{className:t("header"),children:[r(N,{className:t("img"),src:s.picUrl&&_(s.picUrl,200)}),e("div",{className:t("right"),children:[e("div",{className:t("title"),children:[r("span",{children:n?"\u4ED8\u8D39\u7CBE\u54C1":"\u7535\u53F0"}),r("strong",{children:s.name})]}),n?P():k()]})]}),r("section",{className:t("tabs"),children:e(p,{children:[n&&r(p.TabPane,{tab:"\u8BE6\u60C5",children:e("div",{className:i("detail"),children:[r("h3",{className:i("detail-title"),children:"\u7535\u53F0\u5185\u5BB9\u7B80\u4ECB"}),r("p",{children:s.desc}),v.length>0&&e(m,{children:[r("h3",{className:i("detail-title"),children:"\u6700\u8FD1\u66F4\u65B0"}),v.map(a=>r(E,{item:a,onItemClick:F},a.id))]}),l.length>0&&e(m,{children:[r("h3",{className:i("detail-title"),children:"\u514D\u8D39\u8BD5\u542C >"}),l.map(a=>r(E,{item:a,onItemClick:F},a.id))]}),r("h3",{className:D(i("detail-title"),i("detail-notice")),children:"\u8D2D\u4E70\u987B\u77E5"}),e("p",{children:["1. \u672C\u97F3\u9891\u4E3A\u4ED8\u8D39\u8BA2\u9605\u4EA7\u54C1\uFFE512.9/12\u671F\uFF0C\u8D2D\u4E70\u6210\u529F\u540E\u5373\u53EF\u7545\u542C/\u4E0B\u8F7D",r("br",{}),"2. \u8BF7\u5728\u7F51\u6613\u4E91\u97F3\u4E50\u624B\u673AAPP\u652F\u4ED8\u8D2D\u4E70\uFF0C\u8D2D\u4E70\u540E\u652F\u6301\u79FB\u52A8\u3001PC\u3001Web\u7B49\u7AEF\u6536\u542C",r("br",{}),"3. \u8D2D\u4E70\u6210\u529F\u540E\u4E0D\u53EF\u9000\u6B3E\uFF0C\u540C\u65F6\u4E0D\u652F\u6301\u8F6C\u8BA9\uFF0C\u656C\u8BF7\u8C05\u89E3\uFF1B",r("br",{}),"4. \u8D2D\u4E70\u8FC7\u7A0B\u9047\u5230\u4EFB\u4F55\u95EE\u9898\uFF0C\u8BF7\u79C1\u4FE1\u8054\u7CFB@\u4E91\u97F3\u4E50\u5BA2\u670D"]})]})},"0"),e(p.TabPane,{tab:"\u8282\u76EE",children:[e("div",{className:i("control"),children:[e("div",{children:["\u5171",s.programCount,"\u671F"]}),e("div",{className:i("control-right"),children:[r("strong",{children:"\u6392\u5E8F"}),r(G,{className:i("icon")}),r(H,{className:i("icon")})]})]}),u.map(a=>r(E,{item:a,onItemClick:F},a.id))]},"1"),!n&&r(p.TabPane,{tab:"\u8BA2\u9605\u8005",children:r(V,{id:h})},"3")]})})]})};export{sr as default};
