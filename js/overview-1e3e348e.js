import{u as w,r as i,g as l,j as a}from"./react-34ba0285.js";import{d as N,r as b,T as F,p as A,k as P,D as S,c as T,b as B,aE as I,l as O,o as j}from"./index-01b98e4e.js";import{s as C}from"./index-a0b34f11.js";import{m as M,P as R,ak as U,o as H}from"./vendor-ddfd0f27.js";import{a as L,u as q}from"./react-redux-b094955d.js";import"./lodash-536b9069.js";import"./react-router-dom-46eb6367.js";const z=""+new URL("../png/top50-cb618a89.png",import.meta.url).href,x=({id:u,title:c="\u70ED\u95E850\u9996",imgUrl:m=z,data:t,isAlbum:v})=>{const k=L(),{push:r}=w(),[f,p]=i.exports.useState(!1),D=[{key:"ordinal"},{key:"name"},{key:"dt",format:A}],E=i.exports.useMemo(()=>f?t:t.slice(0,10),[f,t]),o=q(e=>!!e.user.cookie);function g(e=0){k(P({current:e,tracks:t,fm:[]}))}function d(){!u||(v?r(S.list(u,"album")):o?r(S.list(u)):H.error("\u9700\u8981\u767B\u5F55\uFF0C\u624D\u80FD\u67E5\u770B\u4ED6\u4EBA\u6B4C\u5355\u4FE1\u606F>_<"))}function h(){}return i.exports.useEffect(()=>{t.length<=10&&t.length>0&&p(!0)},[t]),l("section",{className:n("item"),children:[a(N,{src:b(m,150),className:M(n("img"),{[C["--top50"]]:c==="\u70ED\u95E850\u9996"}),onClick:d}),l("div",{className:n("right"),children:[l("header",{className:n("header"),children:[a("h2",{children:c}),l("div",{className:n("icon"),children:[a(R,{onClick:()=>g()}),a(U,{onClick:h})]})]}),l("div",{className:n("table"),children:[a(F,{noHead:!0,columns:D,data:E,onDoubleClick:g}),!f&&t.length>0&&a("footer",{className:n("footer"),onClick:()=>p(!0),children:l("div",{children:["\u67E5\u770B\u5168\u90E8",t.length,"\u9996 >"]})})]})]})]})},n=T("overview",C),X=({id:u,data:c,isAlbum:m,myself:t})=>{const[v,k]=i.exports.useState([]),r=i.exports.useRef(null),[f,p]=i.exports.useState([]),[D,E]=i.exports.useState("\u52A0\u8F7D\u4E2D...");let o=0;async function g(){const e=await I(u);k(e.songs)}async function d(e){const s=c[e];if(!(s!=null&&s.id))return;const y=await O(s.id);s.songs=y.songs}async function h(e){if(!t)return;const s=c[e];if(!(s!=null&&s.id))return;const y=await j(s.id);s.songs=y.playlist.tracks}return i.exports.useEffect(()=>(m?(g(),d(o)):h(o),B),[u]),i.exports.useEffect(()=>{if(!(r!=null&&r.current))return;const e=new IntersectionObserver(s=>{s[0].intersectionRatio<=0||(o++,o<c.length?(m?d(o):h(o),p(c.slice(0,o))):E(""))});return e.observe(r.current),()=>{r.current&&e.unobserve(r.current),e.disconnect()}},[]),l("div",{className:n(),children:[m&&a(x,{data:v,isAlbum:!0}),f.map(e=>a(x,{id:e.id,title:e.name,imgUrl:e.picUrl,data:e.songs,isAlbum:m},e.id)),a("footer",{ref:r,className:n("more"),children:D})]})};export{X as default,n as getClass};
