import{s as T}from"./collector.module-394d9900.js";import{P as y,u as M,k as R,aj as E,m as f,ar as J,as as U,z as k,U as A,at as L}from"./vendor-da34c035.js";import{g as s,j as e,r as d,F as h,t as Y}from"./react-db2799b6.js";import{u as w,a as I}from"./react-redux-a59d985d.js";import{d as v,r as N,p as z,c as b,b as P,O as q,P as G,Q as H,R as Q,y as W,t as K,j as g}from"./index-2448f94e.js";import{I as V}from"./index-cb31d04d.js";import"./lodash-536b9069.js";import"./react-router-dom-66f75ae1.js";const C=({item:u,onItemClick:a})=>{const c=b("radio-list");return s("div",{className:c("item"),children:[e("div",{className:c("ordinal"),children:u.serialNum}),e(v,{className:c("cover"),icon:{hoverDisplay:!0},src:N(u.coverUrl,60),onClick:()=>a==null?void 0:a(u.mainSong.id),onIconClick:()=>a==null?void 0:a(u.mainSong.id)}),e("div",{className:c("name"),children:u.name}),s("div",{className:c("play-count"),children:[e(y,{})," ",u.trackCount]}),s("div",{className:c("like-count"),children:[e(M,{})," ",u.likedCount]}),e("div",{className:c("date"),children:R(u.createTime).format("YYYY-MM-DD")}),e("div",{className:c("duration"),children:z(u.duration)})]})},X=({id:u})=>{const a=b("collector",T),[c,m]=d.exports.useReducer(D,[]),n=d.exports.useRef(null);let l=-1;async function F(){var o;if(!u)return;const i=await q(u,l);m({type:l===-1?"reset":"add",payload:i.subscribers}),(o=n.current)==null||o.call(n,i.hasMore),l=i.time}function D(i,{type:t="reset",payload:o}){return t==="reset"?o:[...i,...o]}return d.exports.useEffect(()=>(F(),P),[u]),s(h,{children:[e("div",{className:a(),children:c.map(i=>s("div",{className:a("item"),children:[e(v,{className:a("img"),src:N(i.avatarUrl,100)}),s("div",{children:[e("div",{className:a("title"),children:i.nickname}),i.signature&&e("div",{className:a("subtitle"),children:i.signature})]})]},i.userId))}),e(V,{ref:n,cb:F})]})},te=()=>{const u=b("list"),a=b("radio-list"),c=Y(),m=d.exports.useMemo(()=>Number(c.id),[c.id]),n=d.exports.useMemo(()=>!!c.type,[c.type]),[l,F]=d.exports.useState([]),D=d.exports.useMemo(()=>l.sort((r,p)=>r.createTime-p.createTime).slice(0,3),[l]),i=d.exports.useMemo(()=>l.filter(r=>r.programFeeType===5),[l]),t=w(r=>r.djDetail),o=I();async function S(){const r=await G(m);o(H(r.data))}async function x(){const r=await Q(m);F(r.programs)}async function B(r){o(W(r))}function j(){var r;return s(h,{children:[s("div",{className:u("user-info"),children:[e("img",{src:t.dj&&K(N(t.dj.avatarUrl,30)),alt:"avatar"}),e("a",{children:(r=t.dj)==null?void 0:r.nickname})]}),s("div",{className:u("control"),children:[e(g,{compose:!0}),s(g,{children:[e(k,{}),"\u5DF2\u8BA2\u9605(",t.subCount,")"]}),s(g,{children:[e(A,{}),"\u5206\u4EAB(",t.shareCount,")"]})]}),s("div",{className:a("tag"),children:[e("span",{children:t.category}),e("strong",{children:t.desc})]})]})}function O(){var r,p;return s(h,{children:[s("div",{className:a("price"),children:["\xA5",(((r=t==null?void 0:t.feeInfo)==null?void 0:r.originalPrice)||0)/100]}),s("div",{className:a("buttons"),children:[s("button",{className:f(a("button"),"--bg"),children:[e(L,{}),"\u7ACB\u5373\u8D2D\u4E70"]}),s("button",{className:f(a("button"),"--border"),children:[e(y,{}),"\u514D\u8D39\u8BD5\u542C"]}),s(g,{children:[e(A,{}),"\u5206\u4EAB(175)"]})]}),e("div",{className:a("slogan"),children:(p=t.feeInfo)==null?void 0:p.slogan}),e("small",{className:a("brief"),children:"\u6700\u65B0\u4E0A\u67B6"})]})}return d.exports.useEffect(()=>{if(!Number.isNaN(m))return S(),x(),P},[m]),s("div",{className:u(),children:[s("header",{className:u("header"),children:[e(v,{className:u("img"),src:t.picUrl&&N(t.picUrl,200)}),s("div",{className:u("right"),children:[s("div",{className:u("title"),children:[e("span",{children:n?"\u4ED8\u8D39\u7CBE\u54C1":"\u7535\u53F0"}),e("strong",{children:t.name})]}),n?O():j()]})]}),e("section",{className:u("tabs"),children:s(E,{children:[n&&e(E.TabPane,{tab:"\u8BE6\u60C5",children:s("div",{className:a("detail"),children:[e("h3",{className:a("detail-title"),children:"\u7535\u53F0\u5185\u5BB9\u7B80\u4ECB"}),e("p",{children:t.desc}),D.length>0&&s(h,{children:[e("h3",{className:a("detail-title"),children:"\u6700\u8FD1\u66F4\u65B0"}),D.map(r=>e(C,{item:r,onItemClick:B},r.id))]}),i.length>0&&s(h,{children:[e("h3",{className:a("detail-title"),children:"\u514D\u8D39\u8BD5\u542C >"}),i.map(r=>e(C,{item:r,onItemClick:B},r.id))]}),e("h3",{className:f(a("detail-title"),a("detail-notice")),children:"\u8D2D\u4E70\u987B\u77E5"}),s("p",{children:["1. \u672C\u97F3\u9891\u4E3A\u4ED8\u8D39\u8BA2\u9605\u4EA7\u54C1\uFFE512.9/12\u671F\uFF0C\u8D2D\u4E70\u6210\u529F\u540E\u5373\u53EF\u7545\u542C/\u4E0B\u8F7D",e("br",{}),"2. \u8BF7\u5728\u7F51\u6613\u4E91\u97F3\u4E50\u624B\u673AAPP\u652F\u4ED8\u8D2D\u4E70\uFF0C\u8D2D\u4E70\u540E\u652F\u6301\u79FB\u52A8\u3001PC\u3001Web\u7B49\u7AEF\u6536\u542C",e("br",{}),"3. \u8D2D\u4E70\u6210\u529F\u540E\u4E0D\u53EF\u9000\u6B3E\uFF0C\u540C\u65F6\u4E0D\u652F\u6301\u8F6C\u8BA9\uFF0C\u656C\u8BF7\u8C05\u89E3\uFF1B",e("br",{}),"4. \u8D2D\u4E70\u8FC7\u7A0B\u9047\u5230\u4EFB\u4F55\u95EE\u9898\uFF0C\u8BF7\u79C1\u4FE1\u8054\u7CFB@\u4E91\u97F3\u4E50\u5BA2\u670D"]})]})},"0"),s(E.TabPane,{tab:"\u8282\u76EE",children:[s("div",{className:a("control"),children:[s("div",{children:["\u5171",t.programCount,"\u671F"]}),s("div",{className:a("control-right"),children:[e("strong",{children:"\u6392\u5E8F"}),e(J,{className:a("icon")}),e(U,{className:a("icon")})]})]}),l.map(r=>e(C,{item:r,onItemClick:B},r.id))]},"1"),!n&&e(E.TabPane,{tab:"\u8BA2\u9605\u8005",children:e(X,{id:m})},"3")]})})]})};export{te as default};
