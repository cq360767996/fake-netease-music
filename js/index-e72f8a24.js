import{ac as G,x as Y,u as $,F as z,O as H,k as L}from"./vendor-87fac478.js";import{r as n,g as a,j as t,t as W,u as U}from"./react-b78be278.js";import{t as q,I as J,c as P,b as K,d as M,r as Q,w as d,j as D,C as X,$ as Z,a0 as ee,D as k,a1 as se,a2 as ae,a3 as te,a4 as oe,a5 as ie,a6 as re}from"./index-c071a80c.js";import{W as ne}from"./write-comment-e61fbeb1.js";import"./lodash-536b9069.js";import"./react-redux-20b856b3.js";import"./react-router-dom-13d0c15b.js";const le="_video_1pcl7_1",ce="_video__control_1pcl7_14",ue="_video__pause_1pcl7_29",de={video:le,video__control:ce,video__pause:ue},me=({src:s})=>{const m=P("video",de),[i,e]=n.exports.useState(!1),l=n.exports.useRef(null);return a("div",{className:m(),children:[t("video",{ref:l,src:q(s),autoPlay:!0,controls:!0,onPause:()=>e(!0),onPlay:()=>e(!1)}),i&&t(J,{type:"play",size:"giant",className:m("pause"),onClick:()=>{var u;return(u=l.current)==null?void 0:u.play()}})]})},be=()=>{const s=P("play-video"),i=W().id,[e,l]=n.exports.useState(),[u,A]=n.exports.useState(""),[w,E]=n.exports.useState([]),{goBack:T}=U(),B=n.exports.useMemo(()=>!Number.isNaN(Number(i)),[i]),{push:p}=U();async function O(){const o=await se(i),{creator:r,title:c,publishTime:h,playTime:v,videoGroup:C,praisedCount:N,subscribeCount:f,shareCount:g,commentCount:b}=o.data,y=L(h).format("YYYY-MM-DD"),{avatarUrl:_,nickname:V,userId:x}=r;l({title:c,publishTime:y,playTime:v,videoGroup:C,praisedCount:N,subscribeCount:f,shareCount:g,commentCount:b,avatarUrl:_,nickname:V,userId:x})}async function R(){const[o,r]=await Promise.all([ae(Number(i)),te(Number(i))]),{name:c,publishTime:h,playCount:v,videoGroup:C,subCount:N,shareCount:f,commentCount:g,artistName:b,cover:y,artistId:_}=o.data,{likedCount:V}=r;l({title:c,publishTime:h,playTime:v,videoGroup:C,subscribeCount:N,shareCount:f,commentCount:g,praisedCount:V,nickname:b,avatarUrl:y,artistId:_})}async function S(){var r;const o=await oe(i);A((r=o.urls)==null?void 0:r[0].url)}async function j(){const o=await ie(Number(i));A(o.data.url)}async function F(){const o=await re(i);E(o.data)}function I(){e!=null&&e.artistId?p(k.singer(e.artistId)):e!=null&&e.userId&&p(k.user(e.userId))}return n.exports.useEffect(()=>(B?(R(),j()):(O(),S()),F(),K),[i]),t("div",{className:s(),children:a("div",{className:s("detail"),children:[a("div",{className:s("left"),children:[t("h2",{className:s("title"),children:a("span",{onClick:()=>T(),children:[t(G,{})," \u89C6\u9891\u8BE6\u60C5"]})}),t(me,{src:u}),a("div",{className:s("author-wrapper"),children:[e&&a("div",{className:s("author"),children:[t(M,{className:s("avatar"),src:Q(e.avatarUrl,50),onClick:I}),t("strong",{onClick:I,children:e.nickname})]}),a("button",{className:s("follow"),children:[t(Y,{})," \u5173\u6CE8"]})]}),t("h2",{className:s("name"),children:e==null?void 0:e.title}),a("div",{className:s("publish"),children:[a("span",{children:["\u53D1\u5E03: ",e==null?void 0:e.publishTime]}),a("span",{children:["\u64AD\u653E: ",d(e==null?void 0:e.playTime),"\u6B21"]})]}),t("div",{className:s("tags"),children:e==null?void 0:e.videoGroup.map(o=>t("div",{className:s("tag"),children:o.name},o.id))}),a("div",{className:s("button-group"),children:[a("div",{children:[a(D,{children:[t($,{}),"\u8D5E",d(e==null?void 0:e.praisedCount)]}),a(D,{children:[t(z,{}),"\u6536\u85CF",d(e==null?void 0:e.subscribeCount)]}),a(D,{children:[t(H,{}),"\u5206\u4EAB",d(e==null?void 0:e.shareCount)]})]}),t("a",{children:"\u4E3E\u62A5"})]}),a("h3",{className:s("comment"),children:["\u542C\u53CB\u8BC4\u8BBA ",a("span",{children:["(\u5DF2\u6709",e==null?void 0:e.commentCount,"\u8BC4\u8BBA)"]})]}),t(ne,{}),t(X,{id:i,api:B?Z:ee})]}),a("div",{className:s("right"),children:[t("h2",{className:s("title"),children:"\u76F8\u5173\u63A8\u8350"}),w.map(o=>a("div",{className:s("item"),children:[t(M,{className:s("item-img"),src:o.coverUrl,onClick:()=>p(k.playVideo(o.vid))}),a("div",{className:s("item-description"),children:[t("div",{className:s("item-title"),children:o.title}),a("div",{className:s("item-author"),children:["by ",o.creator.reduce((r,c)=>`${r}/${c.userName}`,"").slice(1)]})]})]},o.vid))]})]})})};export{be as default};
