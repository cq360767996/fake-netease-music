var W=Object.defineProperty,X=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var L=(s,t,e)=>t in s?W(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,k=(s,t)=>{for(var e in t||(t={}))M.call(t,e)&&L(s,e,t[e]);if(x)for(var e of x(t))P.call(t,e)&&L(s,e,t[e]);return s},F=(s,t)=>X(s,Z(t));var j=(s,t)=>{var e={};for(var a in s)M.call(s,a)&&t.indexOf(a)<0&&(e[a]=s[a]);if(s!=null&&x)for(var a of x(s))t.indexOf(a)<0&&P.call(s,a)&&(e[a]=s[a]);return e};import{r as C,g as h,j as c,F as q,u as S,h as tt}from"./react-612bda17.js";import{U as et,ad as st,h as nt,k as rt,aa as at,aj as O}from"./vendor-7f089e7e.js";import{b as G,v as ot,S as p,T as V,x as ct,c as $,p as Y,d as z,r as H,y as w,D as U,z as it,A as ut}from"./index-d45ba440.js";import{L as I}from"./index-2de7d4be.js";import{u as lt}from"./react-redux-aeaeff1e.js";import"./lodash-87ac67d6.js";import"./react-router-dom-7eed272f.js";const mt="_song_e7i4c_1",dt="_song__header_e7i4c_4",pt="_song__title_e7i4c_7",_t="_song__wrapper_e7i4c_13",gt="_song__left_e7i4c_33",ht="_song__img_e7i4c_38",yt="_song__footer_e7i4c_45",ft="_song__subtitle_e7i4c_50";var bt={song:mt,song__header:dt,song__title:pt,song__wrapper:_t,"song__best-match":"_song__best-match_e7i4c_18",song__left:gt,song__img:ht,song__footer:yt,song__subtitle:ft};const N=({limit:s=20,type:t,keywords:e,currentType:a,setTotal:o})=>{const[n,r]=C.exports.useState(),[l,m]=C.exports.useState(1),d=C.exports.useMemo(()=>i(n),[t,n]);async function _(f=1,b=20){const T=(f-1)*b,g=await ot({type:t,keywords:e,offset:T,limit:s});o(i(g.result)),r(g.result)}function u(f,b){m(f),_(f,b)}function i(f){return f&&f[{1:"songCount",100:"artistCount",10:"albumCount",1014:"videoCount",1e3:"playlistCount",1006:"songCount",1009:"djRadiosCount",1002:"userprofileCount"}[t]]||0}function E(f){const b=h("div",{className:R("empty"),children:["\u5F88\u62B1\u6B49\uFF0C\u672A\u80FD\u627E\u5230\u4E0E\u201C",c("span",{children:e}),"\u201D\u76F8\u5173\u7684\u4EFB\u4F55\u4FE1\u606F\u3002"]});return n?h(q,{children:[f(n),d>s&&c("footer",{className:R("footer"),children:c(et,{total:d,showSizeChanger:!1,current:l,onChange:u})})]}):b}return C.exports.useEffect(()=>(t===a&&_(),G),[t,e]),{wrapEmpty:E}},vt=s=>{const t=$("song",bt),_=s,{bestMatch:e}=_,a=j(_,["bestMatch"]),o=F(k({},a),{currentType:p.SONG,limit:100}),{wrapEmpty:n}=N(o),{push:r}=S(),l=lt(),m=[{title:"",key:"ordinal"},{title:"",key:"action"},{title:"\u97F3\u4E50\u6807\u9898",key:"name"},{title:"\u6B4C\u624B",render(u){return u.artists.map(i=>c("span",{children:i.name},i.id))}},{title:"\u4E13\u8F91",key:"album.name"},{title:"\u65F6\u957F",key:"duration",format:Y}];function d(u,i){if(!e)return;const b=({album:()=>{const{id:g,name:y,picUrl:v,artist:D}=e[u][0],B=D.name;return{id:g,name:y,imgUrl:v,subtitle:B}},artist:()=>{const{id:g,name:y,picUrl:v}=e[u][0];return{id:g,name:y,imgUrl:v}},playlist:()=>{const{id:g,name:y,coverImgUrl:v}=e[u][0];return{id:g,name:y,imgUrl:v}},song:()=>{const{id:g,name:y,album:v}=e[u],D=v.picUrl;return{id:g,name:y,imgUrl:D}},concert:()=>{const{id:g,cover:y,title:v,time:D}=e[u][0],B=D.reduce((K,Q)=>`${K}-${nt(Q).format("M\u6708D\u65E5")}`,"").slice(1);return{id:g,name:v,imgUrl:y,subtitle:B}}}[u]||w)();function T(g,y){({album:()=>r(U.list(y,"album")),artist:()=>r(U.singer(y)),playlist:()=>r(U.list(y)),song:w,concert:w,orpheus:w})[g]()}return b?h("div",{className:t("best-match"),onClick:()=>T(u,b.id),children:[h("div",{className:t("left"),children:[c(z,{src:H(b.imgUrl,100),className:t("img")}),h("div",{children:[c("div",{children:b.name}),c("div",{className:t("subtitle"),children:b.subtitle})]})]}),c(st,{})]},i):null}return n(u=>h("div",{className:t(),children:[(e==null?void 0:e.orders)&&h("header",{className:t("header"),children:[c("div",{className:t("title"),children:"\u6700\u4F73\u5339\u914D"}),c("div",{className:t("wrapper"),children:e.orders.filter(i=>i!=="orpheus").map(d)})]}),c(V,{columns:m,data:u.songs,onDoubleClick:i=>l(ct(u.songs[i].id))})]}))},Ct=s=>{const t=F(k({},s),{currentType:p.SINGER}),{wrapEmpty:e}=N(t),{push:a}=S();function o(n){return n.map(r=>{const{picUrl:l,name:m,id:d}=r;return{id:d,imgUrl:l,name:m}})}return e(n=>c(I,{data:o(n.artists),onItemClick:({id:r})=>a(U.singer(r))}))},Et=s=>{const t=F(k({},s),{currentType:p.ALBUM}),{wrapEmpty:e}=N(t),{push:a}=S();function o(n){return n.map(r=>{const{picUrl:l,name:m,artist:d,id:_}=r,{name:u,alias:i}=d,E=`${u}\uFF08${i.join(",")}\uFF09`;return{id:_,imgUrl:l,name:m,col2:E}})}return e(n=>c(I,{imgType:"extra",data:o(n.albums),onItemClick:({id:r})=>a(U.list(r,"album"))}))},kt="_video_wgdnq_1",Ft="_video__img_wgdnq_7",Ut="_video__description_wgdnq_12";var J={video:kt,video__img:Ft,video__description:Ut,"--mv":"_--mv_wgdnq_31"};const A=$("video",J),Nt=s=>{const t=F(k({},s),{currentType:p.VIDEO,limit:21}),{wrapEmpty:e}=N(t),{push:a}=S();function o(n){a(U.playVideo(n))}return e(n=>c("div",{className:A(),children:n.videos.map(r=>h("div",{className:A("item"),onClick:()=>o(r.vid),children:[c(z,{src:H(r.coverUrl,460,260),className:A("img")}),h("div",{className:A("description"),children:[c("h2",{className:rt({[J["--mv"]]:r.type===0}),children:r.title}),h("h3",{children:["by ",r.creator.reduce((l,m)=>`${l},${m.userName}`,"").slice(1)]})]})]},r.vid))}))},St=s=>{const t=F(k({},s),{currentType:p.PLAYLIST}),{wrapEmpty:e}=N(t),{push:a}=S();function o(n){return n.map(r=>{const{coverImgUrl:l,name:m,trackCount:d,creator:_,id:u}=r,i=`${d}\u9996`,E=`by ${_.nickname}`;return{id:u,imgUrl:l,name:m,col2:i,col3:E}})}return e(n=>c(I,{data:o(n.playlists),onItemClick:({id:r})=>a(U.list(r))}))},Dt="_lyric_1o214_1";var It={lyric:Dt};const xt=s=>{const t=F(k({},s),{currentType:p.LYRIC}),{wrapEmpty:e}=N(t),a=[{title:"",key:"ordinal"},{title:"",key:"action"},{title:"\u97F3\u4E50\u6807\u9898",key:"name",render(o){return h(q,{children:[c("div",{children:o.name}),c(it,{className:It.lyric,children:o.lyrics.txt})]})}},{title:"\u6B4C\u624B",render(o){return o.artists.map(n=>c("span",{children:n.name},n.id))}},{title:"\u4E13\u8F91",key:"album.name"},{title:"\u65F6\u957F",key:"duration",format:Y}];return e(o=>c(V,{columns:a,data:o.songs}))},wt=s=>{const t=F(k({},s),{currentType:p.RADIO}),{wrapEmpty:e}=N(t);function a(o){return o.map(n=>{const{picUrl:r,name:l,dj:m,id:d}=n,_=`by ${m.nickname}`;return{id:d,imgUrl:r,name:l,col3:_}})}return e(o=>c(I,{data:a(o.djRadios)}))},At=s=>{const t=F(k({},s),{currentType:p.USER,limit:20}),{wrapEmpty:e}=N(t),{push:a}=S();function o(n){return n.map(r=>{const{avatarUrl:l,nickname:m,description:d,userId:_}=r;return{id:_,imgUrl:l,name:m,col3:d}})}return e(n=>c(I,{imgType:"circle",data:o(n.userprofiles),onItemClick:({id:r})=>a(U.user(r))}))},R=$("search-result"),Ot=()=>{const[s,t]=C.exports.useState(0),[e,a]=C.exports.useState(0),[o,n]=C.exports.useState(),{search:r}=tt(),l=C.exports.useMemo(()=>at.parse(r.slice(1),{charset:"utf-8"}).keywords,[r]),m=[{type:p.SONG,key:"song",unit:"\u9996",tab:"\u5355\u66F2",component:vt},{type:p.SINGER,key:"singer",unit:"\u4F4D",tab:"\u6B4C\u624B",component:Ct},{type:p.ALBUM,key:"album",unit:"\u5F20",tab:"\u4E13\u8F91",component:Et},{type:p.VIDEO,key:"video",unit:"\u4E2A",tab:"\u89C6\u9891",component:Nt},{type:p.PLAYLIST,key:"playlist",unit:"\u4E2A",tab:"\u6B4C\u5355",component:St},{type:p.LYRIC,key:"lyric",unit:"\u9996",tab:"\u6B4C\u8BCD",component:xt},{type:p.RADIO,key:"radio",unit:"\u4E2A",tab:"\u4E3B\u64AD\u7535\u53F0",component:wt},{type:p.USER,key:"user",unit:"\u4E2A",tab:"\u7528\u6237",component:At}],d=C.exports.useMemo(()=>m[e],[e]);function _(i){const E=m.findIndex(f=>f.key===i);E>-1&&a(E)}async function u(){const i=await ut(l);n(i.result)}return C.exports.useEffect(()=>(u(),G),[l]),h("div",{className:"search-result",children:[h("header",{className:R("header"),children:[h("strong",{children:[l," "]}),`\u627E\u5230${s}${d.unit}${d.tab==="\u4E3B\u64AD\u7535\u53F0"?"\u7535\u53F0":d.tab}`]}),c(O,{onChange:_,children:m.map(i=>c(O.TabPane,{tab:i.tab,children:c(i.component,{type:d.type,keywords:l,setTotal:t,bestMatch:i.key==="song"?o:void 0})},i.key))})]})};export{Ot as default,R as getClass};
