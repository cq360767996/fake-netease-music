import{u as x,g as r,F as T,j as s,r as n,t as q}from"./react-b78be278.js";import{a as B}from"./react-redux-20b856b3.js";import{c as C,D as N,b as D,d as H,r as j,J as w,U as F,V as S}from"./index-c071a80c.js";import{I as U}from"./index-a64931e3.js";import{P as O}from"./index-834b2365.js";import{au as z,o as v,av as A}from"./vendor-87fac478.js";import"./lodash-536b9069.js";import"./react-router-dom-13d0c15b.js";function G(t,l){const o=C("excellent"),{push:i}=x(),p=r(T,{children:[s(z,{}),"\u7B5B\u9009"]});function u(a){a!==l&&i(N.excellentList(a))}function c(){return r("div",{className:o("popover"),children:[s("header",{className:o("popover-header"),children:s("span",{className:v({"--active":l==="\u5168\u90E8"}),onClick:()=>u("\u5168\u90E8"),children:"\u5168\u90E8\u6B4C\u5355"})}),s("section",{className:o("popover-card"),children:t.map(a=>s("div",{children:s("span",{className:v({"--active":a.name===l}),onClick:()=>u(a.name),children:a.name})},a.id))})]})}return{buttonContext:p,renderPopover:c}}const Z=()=>{const t=C("excellent"),[l,o]=n.exports.useState([]),i=q().id,[p,u]=n.exports.useReducer(R,[]),c=n.exports.useRef(null),{push:a}=x(),P=B(),m=n.exports.useRef(),b=10,{buttonContext:k,renderPopover:E}=G(l,i),f=n.exports.useRef(!0);async function I(){const e=await F();o(e.tags)}async function y(){var d;const e=await S(i,b,m.current),h=m.current===void 0?"reset":"add";u({type:h,payload:e.playlists}),m.current=e.lasttime,e.lasttime||(d=c.current)==null||d.call(c,!1)}function R(e,h){const{type:d,payload:g}=h;return d==="add"?[...e,...g]:g}return n.exports.useEffect(()=>{I()},[]),n.exports.useEffect(()=>(f.current?f.current=!1:y(),D),[i]),r("div",{className:t(),children:[r("header",{className:t("control"),children:[r("div",{className:t("control-title"),children:["\u7CBE\u54C1\u6B4C\u5355 ",s(A,{})]}),s(O,{className:t("control-pick"),placement:"right",context:k,functionChildren:E})]}),s("div",{className:t("card"),children:p.map(e=>r("div",{className:t("item"),children:[s(H,{className:t("img"),icon:{hoverDisplay:!0,placement:"bottom"},src:j(e.coverImgUrl,150),onClick:()=>a(N.list(e.id)),onIconClick:()=>P(w(e.id))}),r("div",{className:t("right"),children:[s("h3",{children:e.name}),r("small",{children:["by ",e.creator.nickname]}),r("div",{className:t("description"),children:[s("span",{children:e.tags.join(",")})," ",e.copywriter]})]})]},e.id))}),s(U,{ref:c,cb:y})]})};export{Z as default};
