import{u as N,r as a,h as l,j as i}from"./react-d9689425.js";import{s as C}from"./index-a9f76cdf.js";import{d as b,r as w,T as F,p as A,k as P,D as S,c as T,b as B,aE as I,l as O,o as j}from"./index-c34386fa.js";import{k as M,J as H,ak as R,n as U}from"./vendor-448858a9.js";import{u as q,a as z}from"./react-redux-ace978cf.js";import"./lodash-87ac67d6.js";import"./react-router-dom-94468eab.js";var G="png/top50-cb618a89.png";const x=({id:u,title:c="\u70ED\u95E850\u9996",imgUrl:m=G,data:t,isAlbum:v})=>{const k=q(),{push:r}=N(),[f,p]=a.exports.useState(!1),D=[{key:"ordinal"},{key:"name"},{key:"dt",format:A}],E=a.exports.useMemo(()=>f?t:t.slice(0,10),[f,t]),o=z(e=>!!e.user.cookie);function g(e=0){k(P({current:e,tracks:t,fm:[]}))}function d(){!u||(v?r(S.list(u,"album")):o?r(S.list(u)):U.error("\u9700\u8981\u767B\u5F55\uFF0C\u624D\u80FD\u67E5\u770B\u4ED6\u4EBA\u6B4C\u5355\u4FE1\u606F>_<"))}function h(){}return a.exports.useEffect(()=>{t.length<=10&&t.length>0&&p(!0)},[t]),l("section",{className:n("item"),children:[i(b,{src:w(m,150),className:M(n("img"),{[C["--top50"]]:c==="\u70ED\u95E850\u9996"}),onClick:d}),l("div",{className:n("right"),children:[l("header",{className:n("header"),children:[i("h2",{children:c}),l("div",{className:n("icon"),children:[i(H,{onClick:()=>g()}),i(R,{onClick:h})]})]}),l("div",{className:n("table"),children:[i(F,{noHead:!0,columns:D,data:E,onDoubleClick:g}),!f&&t.length>0&&i("footer",{className:n("footer"),onClick:()=>p(!0),children:l("div",{children:["\u67E5\u770B\u5168\u90E8",t.length,"\u9996 >"]})})]})]})]})},n=T("overview",C),X=({id:u,data:c,isAlbum:m,myself:t})=>{const[v,k]=a.exports.useState([]),r=a.exports.useRef(null),[f,p]=a.exports.useState([]),[D,E]=a.exports.useState("\u52A0\u8F7D\u4E2D...");let o=0;async function g(){const e=await I(u);k(e.songs)}async function d(e){const s=c[e];if(!(s!=null&&s.id))return;const y=await O(s.id);s.songs=y.songs}async function h(e){if(!t)return;const s=c[e];if(!(s!=null&&s.id))return;const y=await j(s.id);s.songs=y.playlist.tracks}return a.exports.useEffect(()=>(m?(g(),d(o)):h(o),B),[u]),a.exports.useEffect(()=>{if(!(r!=null&&r.current))return;const e=new IntersectionObserver(s=>{s[0].intersectionRatio<=0||(o++,o<c.length?(m?d(o):h(o),p(c.slice(0,o))):E(""))});return e.observe(r.current),()=>{r.current&&e.unobserve(r.current),e.disconnect()}},[]),l("div",{className:n(),children:[m&&i(x,{data:v,isAlbum:!0}),f.map(e=>i(x,{id:e.id,title:e.name,imgUrl:e.picUrl,data:e.songs,isAlbum:m},e.id)),i("footer",{ref:r,className:n("more"),children:D})]})};export{X as default,n as getClass};
