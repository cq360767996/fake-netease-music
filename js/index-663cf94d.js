import{u as x,h as r,F as R,j as s,r as n,q as T}from"./react-d9689425.js";import{c as C,D as N,b as B,d as D,r as H,K as j,U as w,V as F}from"./index-c34386fa.js";import{P as S}from"./index-51519b48.js";import{au as U,k as v,av as O}from"./vendor-448858a9.js";import{u as z}from"./react-redux-ace978cf.js";import{I as A}from"./index-b5c86e7c.js";import"./lodash-87ac67d6.js";import"./react-router-dom-94468eab.js";function G(a,l){const o=C("excellent"),{push:i}=x(),p=r(R,{children:[s(U,{}),"\u7B5B\u9009"]});function u(t){t!==l&&i(N.excellentList(t))}function c(){return r("div",{className:o("popover"),children:[s("header",{className:o("popover-header"),children:s("span",{className:v({"--active":l==="\u5168\u90E8"}),onClick:()=>u("\u5168\u90E8"),children:"\u5168\u90E8\u6B4C\u5355"})}),s("section",{className:o("popover-card"),children:a.map(t=>s("div",{children:s("span",{className:v({"--active":t.name===l}),onClick:()=>u(t.name),children:t.name})},t.id))})]})}return{buttonContext:p,renderPopover:c}}const Z=()=>{const a=C("excellent"),[l,o]=n.exports.useState([]),i=T().id,[p,u]=n.exports.useReducer(q,[]),c=n.exports.useRef(null),{push:t}=x(),P=z(),m=n.exports.useRef(),k=10,{buttonContext:b,renderPopover:E}=G(l,i),f=n.exports.useRef(!0);async function I(){const e=await w();o(e.tags)}async function y(){var d;const e=await F(i,k,m.current),h=m.current===void 0?"reset":"add";u({type:h,payload:e.playlists}),m.current=e.lasttime,e.lasttime||(d=c.current)==null||d.call(c,!1)}function q(e,h){const{type:d,payload:g}=h;return d==="add"?[...e,...g]:g}return n.exports.useEffect(()=>{I()},[]),n.exports.useEffect(()=>(f.current?f.current=!1:y(),B),[i]),r("div",{className:a(),children:[r("header",{className:a("control"),children:[r("div",{className:a("control-title"),children:["\u7CBE\u54C1\u6B4C\u5355 ",s(O,{})]}),s(S,{className:a("control-pick"),placement:"right",context:b,functionChildren:E})]}),s("div",{className:a("card"),children:p.map(e=>r("div",{className:a("item"),children:[s(D,{className:a("img"),icon:{hoverDisplay:!0,placement:"bottom"},src:H(e.coverImgUrl,150),onClick:()=>t(N.list(e.id)),onIconClick:()=>P(j(e.id))}),r("div",{className:a("right"),children:[s("h3",{children:e.name}),r("small",{children:["by ",e.creator.nickname]}),r("div",{className:a("description"),children:[s("span",{children:e.tags.join(",")})," ",e.copywriter]})]})]},e.id))}),s(A,{ref:c,cb:y})]})};export{Z as default};
